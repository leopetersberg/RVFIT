<form class="form-horizontal">
  <script onload="renderChart();" src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
  
  <img style="float: right" height="150px" src="/../../../../RVFIT/forms/logo.jpeg">
  <h1>RV-FIT</h1>
  <h2 style="margin: 50px;">Verteilung der Trainingsvarianten Gesamt</h2>
  <div class="form-group">
    <div>
      <canvas style="margin: 50px;" id="dauerUndAnzahlTrainings"></canvas>
    </div>


    <script cam-script type="text/form-script">

      var variableManager = camForm.variableManager;
      camForm.on('form-loaded', function() {
        variableManager.fetchVariable('VerteilungTVGesamt');
      });
  
      camForm.on('variables-fetched', function() {
        var VerteilungTVGesamt = variableManager.variableValue('VerteilungTVGesamt');
       setVerteilungTVGesamt(VerteilungTVGesamt);
      });
  </script>

    <script>
      var VerteilungTVGesamt = null;
      function setVerteilungTVGesamt(json) {
        VerteilungTVGesamt = json;
      }

      var chartRendert = false;
      addEventListener('mousemove', renderChart);
      function renderChart() {
        if (chartRendert) {
          return;
        }

        console.log(VerteilungTVGesamt);

        const ctx = document.getElementById('dauerUndAnzahlTrainings');


        //x ist die vergagnenen Tage
        //x = 0 ist das letzte Training
        //y ist die Anzahl der Trainings
        //x=y*3,5


        const data = {
  "datasets": [
    {
      "label": "Anzahl Trainings",
      "data": [
        {
          "y": 1,
          "x": "2020-05-04",
          "r": 5
        },
        {
          "y": 1,
          "x": "2022-12-02",
          "r": 5
        },
        {
          "y": 11,
          "x": "2022-12-02",
          "r": 5
        }
      ]
    }
  ],
  "backgroundColor": [
    "green"
  ]
};



        const config = {
          type: 'bubble',
          data: data,
          options: {
            scales: {
              x: {
                //max : '2022-12-14',
                type: 'time',
                time: {
                  unit: 'day'
                }
              },
              y: {
                min : 0,
                max: 24
              }
            }
          }
        };

        new Chart(ctx, config);
        chartRendert = true;
      }
    </script>
  </div>
</form>